[rewrite] implementation of dijkstra's algorithm
